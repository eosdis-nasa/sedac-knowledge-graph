from neo4j import GraphDatabase
import json

NEO4J_URI = "bolt://127.0.0.1:7687"  # e.g., "bolt://localhost:7687"
NEO4J_USER = "neo4j"
NEO4J_PASSWORD = "Th3pr0j3ct2ishere!"

def get_data():
    data = []
    with open('C:\Users\bdavis21\Downloads\sedac_downloads_1st_week 1.jsonl', 'r', encoding='utf-16') as f:
        for line in f:
            try:
             json_object = json.loads(line)
             # do something with it
            except json.JSONDecodeError as e:
                print(f"Error decoding JSON on line: {line.strip()} - {e}")


# Initialize the Python driver for Neo4j
driver = GraphDatabase.driver(NEO4J_URI, auth=(NEO4J_USER, NEO4J_PASSWORD))
get_data()

def create_node(transaction, nodeName, nodeGreeting):
    """
    Runs a Cypher query that creates a node with two properties:
    nodeName (the name of the node) and nodeGreeting (a string
    greeting to print)

    Args:
        transaction (neo4j.ManagedTransaction): The Neo4j object that executes
        the Cypher query.
        nodeName (string): The name of the node that is created.
        nodeGreeting (string): The greeting of the node that is created.

    Returns:
        Nothing

    Raises:
        TransactionError: If operations are made when transaction is closed.
        CypherSyntaxError: If there are any Cypher syntax mistakes.
    """
    # Execute a query using the ManagedTransaction object to create
    # a node, assigning the node the properties "name" and "greeting".
    # Pass in the values from the nodeName and nodeGreeting parameters
    # to the name and greeting properties respectively
    transaction.run("CREATE (n:NODE {name: $name, greeting: $greeting})",
           name=nodeName,
           greeting=nodeGreeting)
    
# Create a Neo4j session, which allows you to perform operations on the
# graph. Use the session to execute the query function
with driver.session() as session:
    # The node will have the name "Test Node" and the greeting
    # "Hello World!"
    session.execute_write(create_node, "Test Node2", "Hello World!")

